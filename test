from openai import OpenAI
import os

client = OpenAI(api_key=os.environ["OPENAI_API_KEY"])

def simplify_instructions(raw_text: str):
    system_prompt = """
    You are a medical education assistant.
    Your job is to rephrase medical or device instructions into plain, easy-to-understand language.
    - Use simple terms and short sentences.
    - Define medical words using reputable sources like WebMD or Harvard Health.
    - Never remove or change safety warnings.
    - Never give personal medical advice or make recommendations.
    - If a step seems unclear, say: "Ask your healthcare provider for clarification."
    - Always include: (Source: Educational summary, not medical advice.)
    """

    response = client.responses.create(
        model="gpt-4o-mini",
        input=f"{system_prompt}\n\nUser Input:\n{raw_text}",
        temperature=0.2,
        max_output_tokens=800
    )

    return response.output_text


# Example usage:
user_text = "How do I put in my insulin pump?"
output = simplify_instructions(user_text)
print(output)
